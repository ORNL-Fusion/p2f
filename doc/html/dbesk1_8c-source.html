<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>p2f: src/bessel/dbesk1.c Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.7.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="namespaces.html"><span>Modules</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    </ul>
  </div>
<h1>src/bessel/dbesk1.c</h1><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/* Bessel K_1(x) function in double precision */</span>
<a name="l00002"></a>00002 
<a name="l00003"></a>00003 <span class="preprocessor">#include &lt;math.h&gt;</span>
<a name="l00004"></a>00004 
<a name="l00005"></a>00005 <span class="keywordtype">double</span> dbesk1(<span class="keywordtype">double</span> x)
<a name="l00006"></a>00006 {
<a name="l00007"></a>00007     <span class="keywordtype">int</span> k;
<a name="l00008"></a>00008     <span class="keywordtype">double</span> t, y, v;
<a name="l00009"></a>00009     <span class="keyword">static</span> <span class="keywordtype">double</span> a[16] = {
<a name="l00010"></a>00010         1.5151605362537935201e-13, 3.363790951353651035e-11, 
<a name="l00011"></a>00011         5.6514041131016827202e-9, 6.7816840255069534052e-7, 
<a name="l00012"></a>00012         5.4253472222259226487e-5, 0.0026041666666666637057, 
<a name="l00013"></a>00013         0.06250000000000000009, 0.5, 
<a name="l00014"></a>00014         -8.9790303384748696588e-11, -1.4029047449249185771e-8, 
<a name="l00015"></a>00015         -1.5592893752540998113e-6, -1.1253607018469017569e-4, 
<a name="l00016"></a>00016         -0.0046421827665011579173, -0.085370719728648409609, 
<a name="l00017"></a>00017         -0.3079657578292062966, 1.0000000000000000004
<a name="l00018"></a>00018     };
<a name="l00019"></a>00019     <span class="keyword">static</span> <span class="keywordtype">double</span> b[120] = {
<a name="l00020"></a>00020         -9.4055461896630579928e-12, 3.1307934665844664773e-11, 
<a name="l00021"></a>00021         4.2005295001519243251e-10, -4.1636196779679820012e-9, 
<a name="l00022"></a>00022         1.4483026181700966164e-8, 1.1661000205428816914e-8, 
<a name="l00023"></a>00023         -3.5023996724943046209e-7, 1.4404279316339005012e-6, 
<a name="l00024"></a>00024         5.358156415715824208e-7, -3.5249754038612334639e-5, 
<a name="l00025"></a>00025         1.7150324075631641453e-4, -4.1276362611239191024e-5, 
<a name="l00026"></a>00026         -0.0046943110979636602591, 0.035085369853392357659, 
<a name="l00027"></a>00027         0.20063574339907819159, 
<a name="l00028"></a>00028         3.3998989888944034586e-11, 7.1558979072937373055e-11, 
<a name="l00029"></a>00029         -2.9226856932927698732e-9, 1.4591620256525610213e-8, 
<a name="l00030"></a>00030         -6.6141635609854161666e-9, -1.9991101838984472332e-7, 
<a name="l00031"></a>00031         5.9185836628873530572e-7, 1.9562880347358085687e-6, 
<a name="l00032"></a>00032         -1.5814366450418102764e-5, 7.6791682910944612028e-6, 
<a name="l00033"></a>00033         2.8354678948323983936e-4, -0.0010217932669418690641, 
<a name="l00034"></a>00034         -0.0032205661865210048433, 0.043497494842354644077, 
<a name="l00035"></a>00035         0.16110284302315089935, 
<a name="l00036"></a>00036         -2.0933987679665541827e-10, 7.9503322090520447316e-10, 
<a name="l00037"></a>00037         3.8000150948242575774e-9, -2.3076136195585571309e-8, 
<a name="l00038"></a>00038         -2.3902880302550799653e-8, 3.1914500937804377478e-7, 
<a name="l00039"></a>00039         3.2639909831082417694e-7, -5.3166994792995439449e-6, 
<a name="l00040"></a>00040         -3.1109524694269240094e-6, 9.2575906966353273247e-5, 
<a name="l00041"></a>00041         7.5063709094147644746e-7, -0.0017416491592625765379, 
<a name="l00042"></a>00042         0.0012138560335171676007, 0.045879687144659643175, 
<a name="l00043"></a>00043         0.11566544716132846709, 
<a name="l00044"></a>00044         3.1582384905164908749e-10, -1.9959561818098999516e-9, 
<a name="l00045"></a>00045         8.6959328920030927557e-10, 1.1642778282445577109e-8, 
<a name="l00046"></a>00046         4.3552264337818440471e-8, -1.5057982160481803238e-7, 
<a name="l00047"></a>00047         -1.0101729117980989857e-6, 7.7002002510177612013e-7, 
<a name="l00048"></a>00048         1.9580574235590194233e-5, 1.9358461980242834361e-5, 
<a name="l00049"></a>00049         -3.3932339942485532728e-4, -9.3416673584325090073e-4, 
<a name="l00050"></a>00050         0.0055800080455912847227, 0.038668683062477179235, 
<a name="l00051"></a>00051         0.072651643500517000658, 
<a name="l00052"></a>00052         -1.1554749629758510059e-10, 8.2270678758893273006e-10, 
<a name="l00053"></a>00053         -5.0211156951551538591e-10, -1.4929179050554858361e-9, 
<a name="l00054"></a>00054         -2.7107940791526366702e-8, -4.2204764086705349384e-8, 
<a name="l00055"></a>00055         3.7253098167927628867e-7, 2.4374697215363361156e-6, 
<a name="l00056"></a>00056         1.414194200690976837e-6, -4.8766389019473918231e-5, 
<a name="l00057"></a>00057         -2.1681387247526720978e-4, 2.9325729929653405236e-4, 
<a name="l00058"></a>00058         0.0064087534504827239815, 0.026054628289709454356, 
<a name="l00059"></a>00059         0.040156431128194184336, 
<a name="l00060"></a>00060         2.5506555170746221691e-11, -1.3521164018407978152e-10, 
<a name="l00061"></a>00061         -8.3281235274106699399e-11, -9.7764849575562351891e-10, 
<a name="l00062"></a>00062         3.4661828409940354542e-9, 3.9760633711791357544e-8, 
<a name="l00063"></a>00063         1.590290664550452993e-7, -1.4919441249454941275e-7, 
<a name="l00064"></a>00064         -5.3779684992094351263e-6, -2.7513862296246223142e-5, 
<a name="l00065"></a>00065         -9.7880089725297162007e-6, 7.0787668964515789714e-4, 
<a name="l00066"></a>00066         0.0046968199862345387583, 0.014745740181663320127, 
<a name="l00067"></a>00067         0.020048622219583455723, 
<a name="l00068"></a>00068         -3.4824483072529265585e-12, 1.5157161810563380451e-12, 
<a name="l00069"></a>00069         8.5303859696700686144e-12, 3.3455414203743741076e-10, 
<a name="l00070"></a>00070         2.0226016353844285376e-9, 5.312815400326633499e-9, 
<a name="l00071"></a>00071         -3.0799322316418042137e-8, -4.4455408272954712128e-7, 
<a name="l00072"></a>00072         -2.4293274626893384034e-6, -3.2129079340119038354e-6, 
<a name="l00073"></a>00073         5.922540368307538885e-5, 5.6822962576781683532e-4, 
<a name="l00074"></a>00074         0.0027152446516406682732, 0.0074075873691848838485, 
<a name="l00075"></a>00075         0.0093044450815739269849, 
<a name="l00076"></a>00076         -2.7683216166276377232e-13, 3.1986676777610155465e-12, 
<a name="l00077"></a>00077         9.4142986954031445666e-12, 6.7934609179456399334e-11, 
<a name="l00078"></a>00078         3.485152941147002933e-11, -2.5785248508896551557e-9, 
<a name="l00079"></a>00079         -2.8310220027112571258e-8, -1.6384131113072271115e-7, 
<a name="l00080"></a>00080         -3.2521663350596379097e-7, 4.038138875762230716e-6, 
<a name="l00081"></a>00081         5.1917606978077281001e-5, 3.3420027947470126154e-4, 
<a name="l00082"></a>00082         0.0013699550623118247094, 0.0034405619148342271096, 
<a name="l00083"></a>00083         0.0041042919106665762794
<a name="l00084"></a>00084     };
<a name="l00085"></a>00085     <span class="keyword">static</span> <span class="keywordtype">double</span> c[120] = {
<a name="l00086"></a>00086         4.5281968025889407937e-12, 1.0806749918195271176e-11, 
<a name="l00087"></a>00087         9.6200972728717669027e-11, 5.721422706362526365e-10, 
<a name="l00088"></a>00088         3.6077804282954825099e-9, 2.2465236858536681852e-8, 
<a name="l00089"></a>00089         1.367696126430873523e-7, 7.9561767489531997361e-7, 
<a name="l00090"></a>00090         4.3014380065615550573e-6, 2.092171390555028559e-5, 
<a name="l00091"></a>00091         8.8079183950590176926e-5, 3.0549414408830252064e-4, 
<a name="l00092"></a>00092         8.1295715613927890473e-4, 0.0014679809476357079195, 
<a name="l00093"></a>00093         0.0013439197177355090057, 
<a name="l00094"></a>00094         7.6019964430402432637e-13, -2.261619859915827119e-13, 
<a name="l00095"></a>00095         1.7904450823779000744e-11, 9.1467054855312232717e-11, 
<a name="l00096"></a>00096         7.1378582044879519122e-10, 4.9925255415445769102e-9, 
<a name="l00097"></a>00097         3.3767315471315546644e-8, 2.1350774539167751457e-7, 
<a name="l00098"></a>00098         1.2314353082655232903e-6, 6.2918685053670619181e-6, 
<a name="l00099"></a>00099         2.7493229298777000013e-5, 9.8085825401369821771e-5, 
<a name="l00100"></a>00100         2.6670282677770444935e-4, 4.8967895428135985381e-4, 
<a name="l00101"></a>00101         4.5418248688489697144e-4, 
<a name="l00102"></a>00102         9.4180115230375147213e-14, 7.5943117003734061145e-14, 
<a name="l00103"></a>00103         3.0335730243874287654e-12, 2.0202796115462268051e-11, 
<a name="l00104"></a>00104         1.6839020189186971198e-10, 1.2907875663127201526e-9, 
<a name="l00105"></a>00105         9.354767612586579892e-9, 6.2471974110281880722e-8, 
<a name="l00106"></a>00106         3.7585985422997380441e-7, 1.9838348288114906484e-6, 
<a name="l00107"></a>00107         8.8884862203671982034e-6, 3.2333259238682810218e-5, 
<a name="l00108"></a>00108         8.9266668913380400243e-5, 1.6589185669844051903e-4, 
<a name="l00109"></a>00109         1.5536921180500113394e-4, 
<a name="l00110"></a>00110         1.5425475332301107271e-14, 2.8674534590132490434e-14, 
<a name="l00111"></a>00111         6.5078462279160216936e-13, 5.0939757793961391211e-12, 
<a name="l00112"></a>00112         4.497983746074897552e-11, 3.6662925847520171711e-10, 
<a name="l00113"></a>00113         2.7848878755089582413e-9, 1.929812005933947782e-8, 
<a name="l00114"></a>00114         1.1950323861976892013e-7, 6.4513432758147478287e-7, 
<a name="l00115"></a>00115         2.9422095033982461936e-6, 1.0854433321174584937e-5, 
<a name="l00116"></a>00116         3.0307433185818899481e-5, 5.684098144306501785e-5, 
<a name="l00117"></a>00117         5.3637016379451945253e-5, 
<a name="l00118"></a>00118         3.1077953698439839352e-15, 8.6899496170729520378e-15, 
<a name="l00119"></a>00119         1.6258562067326054104e-13, 1.4104842571366761537e-12, 
<a name="l00120"></a>00120         1.3019455544084110747e-11, 1.1070466372863950239e-10, 
<a name="l00121"></a>00121         8.6890603844230597917e-10, 6.1793722175049967488e-9, 
<a name="l00122"></a>00122         3.9058865943755615801e-8, 2.1432806981070368523e-7, 
<a name="l00123"></a>00123         9.9034657762983230155e-7, 3.6925185861895664251e-6, 
<a name="l00124"></a>00124         1.0399877577259449786e-5, 1.9644939661550210015e-5, 
<a name="l00125"></a>00125         1.8648773453825584597e-5, 
<a name="l00126"></a>00126         7.2831555285336286457e-16, 2.6077534095895783532e-15, 
<a name="l00127"></a>00127         4.4881202059263153495e-14, 4.1674329383944385626e-13, 
<a name="l00128"></a>00128         3.9760100480223728037e-12, 3.483597635535118301e-11, 
<a name="l00129"></a>00129         2.79932542127702497e-10, 2.0286513276830758107e-9, 
<a name="l00130"></a>00130         1.3018343087118439152e-8, 7.2315927974997999365e-8, 
<a name="l00131"></a>00131         3.3750708681924201599e-7, 1.2688020879407355571e-6, 
<a name="l00132"></a>00132         3.5980954090811587848e-6, 6.8358260635246667316e-6, 
<a name="l00133"></a>00133         6.5208606745808860557e-6, 
<a name="l00134"></a>00134         1.9026412343503745875e-16, 8.0073765508732553766e-16, 
<a name="l00135"></a>00135         1.3245754278055523992e-14, 1.2885201653055058502e-13, 
<a name="l00136"></a>00136         1.2600129301230402587e-12, 1.1283306843147549277e-11, 
<a name="l00137"></a>00137         9.2261481309646814329e-11, 6.7812033168299846818e-10, 
<a name="l00138"></a>00138         4.4020645304595102132e-9, 2.4685719238301517679e-8, 
<a name="l00139"></a>00139         1.1611886719473112509e-7, 4.3940380936523135466e-7, 
<a name="l00140"></a>00140         1.2529878285546791905e-6, 2.3917218527087570384e-6, 
<a name="l00141"></a>00141         2.290757464767187816e-6, 
<a name="l00142"></a>00142         5.3709522135744366512e-17, 2.5239221050372845433e-16, 
<a name="l00143"></a>00143         4.093314714589908336e-15, 4.1152784247617592367e-14, 
<a name="l00144"></a>00144         4.0998840572769381012e-13, 3.7319354625807158852e-12, 
<a name="l00145"></a>00145         3.0921671702920868014e-11, 2.2975898538634445343e-10, 
<a name="l00146"></a>00146         1.5049754445782364328e-9, 8.5030864719789148982e-9, 
<a name="l00147"></a>00147         4.025055939111842381e-8, 1.5312755642491878591e-7, 
<a name="l00148"></a>00148         4.3865020375297892208e-7, 8.4059737392822153101e-7, 
<a name="l00149"></a>00149         8.0785884122023473319e-7
<a name="l00150"></a>00150     };
<a name="l00151"></a>00151     <span class="keyword">static</span> <span class="keywordtype">double</span> d[40] = {
<a name="l00152"></a>00152         9.2371554649979581914e-14, -2.3111336195788410887e-12, 
<a name="l00153"></a>00153         5.7728710326649832559e-11, -1.8002298130091372598e-9, 
<a name="l00154"></a>00154         7.6810375010517145638e-8, -5.2669973752193823306e-6, 
<a name="l00155"></a>00155         0.0010112634961227401357, 0.16180215937964160466, 
<a name="l00156"></a>00156         6.1381146507252683381e-14, -2.1034499679806301862e-12, 
<a name="l00157"></a>00157         5.7090233460448415278e-11, -1.7990724350642330817e-9, 
<a name="l00158"></a>00158         7.6809056078388019946e-8, -5.2669964425290062357e-6, 
<a name="l00159"></a>00159         0.001011263495747828339, 0.16180215937970716383, 
<a name="l00160"></a>00160         4.2458150578401296419e-14, -1.8435733128339016981e-12, 
<a name="l00161"></a>00161         5.5534955081564656595e-11, -1.7938162188526358466e-9, 
<a name="l00162"></a>00162         7.6798230945934117807e-8, -5.2669828728791921259e-6, 
<a name="l00163"></a>00163         0.0010112634861753356559, 0.16180215938263409582, 
<a name="l00164"></a>00164         3.0314798962267007518e-14, -1.5915009905364214455e-12, 
<a name="l00165"></a>00165         5.3275907427402047438e-11, -1.7824862013841369751e-9, 
<a name="l00166"></a>00166         7.676389035644707581e-8, -5.2669199860465945909e-6, 
<a name="l00167"></a>00167         0.0010112634217687349189, 0.16180215941108227283, 
<a name="l00168"></a>00168         2.2211515002229271212e-14, -1.3664088221521734796e-12, 
<a name="l00169"></a>00169         5.0585177270502341602e-11, -1.7645432205894533462e-9, 
<a name="l00170"></a>00170         7.6691805594577373698e-8, -5.2667455286976269634e-6, 
<a name="l00171"></a>00171         0.001011263186281097458, 0.16180215954783127877
<a name="l00172"></a>00172     };
<a name="l00173"></a>00173 
<a name="l00174"></a>00174     <span class="keywordflow">if</span> (x &lt; 0.8) {
<a name="l00175"></a>00175         t = x * x;
<a name="l00176"></a>00176         y = (((((((a[0] * t + a[1]) * t + 
<a name="l00177"></a>00177             a[2]) * t + a[3]) * t + a[4]) * t + 
<a name="l00178"></a>00178             a[5]) * t + a[6]) * t + a[7]) * x;
<a name="l00179"></a>00179         y = (((((((a[8] * t + a[9]) * t + 
<a name="l00180"></a>00180             a[10]) * t + a[11]) * t + a[12]) * t + 
<a name="l00181"></a>00181             a[13]) * t + a[14]) * t + a[15]) / x + 
<a name="l00182"></a>00182             y * log(x);
<a name="l00183"></a>00183     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (x &lt; 5.5) {
<a name="l00184"></a>00184         v = 3 / x;
<a name="l00185"></a>00185         t = x - v;
<a name="l00186"></a>00186         k = (int) (t + 3);
<a name="l00187"></a>00187         t = (k - 2) - t;
<a name="l00188"></a>00188         k *= 15;
<a name="l00189"></a>00189         y = ((((((((((((((b[k] * t + b[k + 1]) * t + 
<a name="l00190"></a>00190             b[k + 2]) * t + b[k + 3]) * t + b[k + 4]) * t + 
<a name="l00191"></a>00191             b[k + 5]) * t + b[k + 6]) * t + b[k + 7]) * t + 
<a name="l00192"></a>00192             b[k + 8]) * t + b[k + 9]) * t + b[k + 10]) * t + 
<a name="l00193"></a>00193             b[k + 11]) * t + b[k + 12]) * t + b[k + 13]) * t + 
<a name="l00194"></a>00194             b[k + 14]) * v;
<a name="l00195"></a>00195     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (x &lt; 12.5) {
<a name="l00196"></a>00196         k = (int) x;
<a name="l00197"></a>00197         t = (k + 1) - x;
<a name="l00198"></a>00198         k = 15 * (k - 5);
<a name="l00199"></a>00199         y = (((((((((((((c[k] * t + c[k + 1]) * t + 
<a name="l00200"></a>00200             c[k + 2]) * t + c[k + 3]) * t + c[k + 4]) * t + 
<a name="l00201"></a>00201             c[k + 5]) * t + c[k + 6]) * t + c[k + 7]) * t + 
<a name="l00202"></a>00202             c[k + 8]) * t + c[k + 9]) * t + c[k + 10]) * t + 
<a name="l00203"></a>00203             c[k + 11]) * t + c[k + 12]) * t + c[k + 13]) * t + 
<a name="l00204"></a>00204             c[k + 14];
<a name="l00205"></a>00205     } <span class="keywordflow">else</span> {
<a name="l00206"></a>00206         t = 60 / x;
<a name="l00207"></a>00207         k = 8 * ((int) t);
<a name="l00208"></a>00208         y = (((((((d[k] * t + d[k + 1]) * t + 
<a name="l00209"></a>00209             d[k + 2]) * t + d[k + 3]) * t + d[k + 4]) * t + 
<a name="l00210"></a>00210             d[k + 5]) * t + d[k + 6]) * t + d[k + 7]) * 
<a name="l00211"></a>00211             sqrt(t) * exp(-x);
<a name="l00212"></a>00212     }
<a name="l00213"></a>00213     <span class="keywordflow">return</span> y;
<a name="l00214"></a>00214 }
<a name="l00215"></a>00215 
</pre></div></div>
<hr size="1"><address style="text-align: right;"><small>Generated on Fri May 1 12:02:22 2009 for p2f by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.7.1 </small></address>
</body>
</html>
