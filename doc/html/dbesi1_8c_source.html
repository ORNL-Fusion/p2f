<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>p2f: src/bessel/dbesi1.c Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css">
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.9 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="namespaces.html"><span>Modules</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    </ul>
  </div>
<h1>src/bessel/dbesi1.c</h1><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/* Bessel I_1(x) function in double precision */</span>
<a name="l00002"></a>00002 
<a name="l00003"></a>00003 <span class="preprocessor">#include &lt;math.h&gt;</span>
<a name="l00004"></a>00004 
<a name="l00005"></a>00005 <span class="keywordtype">double</span> dbesi1(<span class="keywordtype">double</span> x)
<a name="l00006"></a>00006 {
<a name="l00007"></a>00007     <span class="keywordtype">int</span> k;
<a name="l00008"></a>00008     <span class="keywordtype">double</span> w, t, y;
<a name="l00009"></a>00009     <span class="keyword">static</span> <span class="keywordtype">double</span> a[60] = {
<a name="l00010"></a>00010         1.2787464404046789181e-10, 3.5705860060088241077e-9, 
<a name="l00011"></a>00011         9.961153761934733504e-8, 2.2395070088633043177e-6, 
<a name="l00012"></a>00012         4.0312466928887462346e-5, 5.6437387840203722356e-4, 
<a name="l00013"></a>00013         0.0059259259312934746096, 0.04444444444349900887, 
<a name="l00014"></a>00014         0.22222222222232042719, 0.66666666666666139867, 
<a name="l00015"></a>00015         1.0000000000000001106, 0.49999999999999999962, 
<a name="l00016"></a>00016         1.7281952384448634449e-10, 3.064720455997639013e-9, 
<a name="l00017"></a>00017         1.0237662138842827028e-7, 2.2299494417341498163e-6, 
<a name="l00018"></a>00018         4.0335364374929326943e-5, 5.6433440269141349899e-4, 
<a name="l00019"></a>00019         0.0059259754885893798654, 0.04444439941088039787, 
<a name="l00020"></a>00020         0.2222222511283502673, 0.66666665422146063244, 
<a name="l00021"></a>00021         1.0000000032274936821, 0.49999999961866867205, 
<a name="l00022"></a>00022         2.3216048939948030996e-10, 1.7443372702334489579e-9, 
<a name="l00023"></a>00023         1.1596478963485415499e-7, 2.1446755518623035147e-6, 
<a name="l00024"></a>00024         4.0697440347437076195e-5, 5.6324394900433192204e-4, 
<a name="l00025"></a>00025         0.0059283484996093060678, 0.044440673899150997921, 
<a name="l00026"></a>00026         0.2222263801685265786, 0.66666358151576732094, 
<a name="l00027"></a>00027         1.0000013834029985337, 0.49999971643129650249, 
<a name="l00028"></a>00028         3.1013758938255172562e-10, -8.4813676145611694984e-10, 
<a name="l00029"></a>00029         1.5544980187411802596e-7, 1.7811109378708045726e-6, 
<a name="l00030"></a>00030         4.2945322199060856985e-5, 5.5344850176852353639e-4, 
<a name="l00031"></a>00031         0.0059590327716950614802, 0.044371611097707060659, 
<a name="l00032"></a>00032         0.22233578241986401111, 0.6665474730046331531, 
<a name="l00033"></a>00033         1.0000756505206705927, 0.49997803664415994554, 
<a name="l00034"></a>00034         4.1214758313965020365e-10, -5.361331773534742944e-9, 
<a name="l00035"></a>00035         2.4661360807517345161e-7, 6.7144593918926723203e-7, 
<a name="l00036"></a>00036         5.1988027944945587571e-5, 5.0165568586065803067e-4, 
<a name="l00037"></a>00037         0.0061717530047005289953, 0.043745229577317251404, 
<a name="l00038"></a>00038         0.22363147971477747996, 0.6647546913111766024, 
<a name="l00039"></a>00039         1.0015686689447547657, 0.49941120439785391891
<a name="l00040"></a>00040     };
<a name="l00041"></a>00041     <span class="keyword">static</span> <span class="keywordtype">double</span> b[70] = {
<a name="l00042"></a>00042         6.6324787943143095845e-8, 4.5125928898466638619e-7, 
<a name="l00043"></a>00043         6.7937793134877246623e-6, 7.4580507871505926302e-5, 
<a name="l00044"></a>00044         7.6866382927334005919e-4, 0.0071185174803491859307, 
<a name="l00045"></a>00045         0.058721838073486424416, 0.42473949281714196041, 
<a name="l00046"></a>00046         2.6396965606282079123, 13.710008536637016903, 
<a name="l00047"></a>00047         57.158647688180932003, 179.46182892089389037, 
<a name="l00048"></a>00048         377.57997362398478619, 399.87313678256009819, 
<a name="l00049"></a>00049         1.7652713206027939711e-7, 1.1988179244834708057e-6, 
<a name="l00050"></a>00050         1.8037851545747139231e-5, 1.9775785516370314656e-4, 
<a name="l00051"></a>00051         0.0020354870702829387283, 0.0188221641910322536, 
<a name="l00052"></a>00052         0.15500485219010424263, 1.119010001056057321, 
<a name="l00053"></a>00053         6.9391565185406617552, 35.948170579648649345, 
<a name="l00054"></a>00054         149.41909525103032616, 467.42979492780642582, 
<a name="l00055"></a>00055         979.04227423171290408, 1030.9147225169564443, 
<a name="l00056"></a>00056         4.7022299276154507603e-7, 3.1878571710170115972e-6, 
<a name="l00057"></a>00057         4.7940153875711448496e-5, 5.2496623508411440227e-4, 
<a name="l00058"></a>00058         0.0053968661134780824779, 0.049837081920693776234, 
<a name="l00059"></a>00059         0.40979593830387765545, 2.9533186922862948404, 
<a name="l00060"></a>00060         18.278176130722516369, 94.47649715018912107, 
<a name="l00061"></a>00061         391.66075612645333624, 1221.4182034643210345, 
<a name="l00062"></a>00062         2548.6177980961291004, 2670.9883037012546541, 
<a name="l00063"></a>00063         1.2535083724002034147e-6, 8.484587142065570825e-6, 
<a name="l00064"></a>00064         1.2753227372734042108e-4, 0.0013950105363562648921, 
<a name="l00065"></a>00065         0.014325473993765291906, 0.13212452778932829125, 
<a name="l00066"></a>00066         1.0849287786885151432, 7.8068089156260172673, 
<a name="l00067"></a>00067         48.232254570679165833, 248.80659424902394371, 
<a name="l00068"></a>00068         1029.0736929484210803, 3200.5629438795801652, 
<a name="l00069"></a>00069         6656.7749162019607914, 6948.8586598121632302, 
<a name="l00070"></a>00070         3.3439394490599745013e-6, 2.2600596902211837757e-5, 
<a name="l00071"></a>00071         3.3955927589987356838e-4, 0.0037105306061050972474, 
<a name="l00072"></a>00072         0.038065263634919156421, 0.35068223415665236079, 
<a name="l00073"></a>00073         2.8760027832105027316, 20.665999500843274339, 
<a name="l00074"></a>00074         127.47939148516390205, 656.43636874254000885, 
<a name="l00075"></a>00075         2709.524283793247992, 8407.1174233600734871, 
<a name="l00076"></a>00076         17437.146284159740233, 18141.3487816388316
<a name="l00077"></a>00077     };
<a name="l00078"></a>00078     <span class="keyword">static</span> <span class="keywordtype">double</span> c[45] = {
<a name="l00079"></a>00079         -2.8849790431465382128e-15, -3.5125350943844774657e-14, 
<a name="l00080"></a>00080         -7.485086701370741975e-13, -1.8383904048277485153e-11, 
<a name="l00081"></a>00081         -5.7303556446977223342e-10, -2.4449502737311496525e-8, 
<a name="l00082"></a>00082         -1.6765373351766929724e-6, -3.2189516835265773471e-4, 
<a name="l00083"></a>00083         0.051503226936425277377, 
<a name="l00084"></a>00084         -5.8674306822281631119e-15, -9.4884898451194085565e-15, 
<a name="l00085"></a>00085         -8.503386513660036434e-13, -1.8142997866945285736e-11, 
<a name="l00086"></a>00086         -5.7340238386338193949e-10, -2.4449138101742183665e-8, 
<a name="l00087"></a>00087         -1.6765375646678855842e-6, -3.2189516826945356325e-4, 
<a name="l00088"></a>00088         0.051503226936412017608, 
<a name="l00089"></a>00089         -1.4723362506764340882e-14, 1.3945147385179042899e-13, 
<a name="l00090"></a>00090         -1.9618041857586930923e-12, -1.3343606394065121821e-11, 
<a name="l00091"></a>00091         -5.8649674606973244159e-10, -2.4426060539669553778e-8, 
<a name="l00092"></a>00092         -1.6765631828366988006e-6, -3.2189515191449587253e-4, 
<a name="l00093"></a>00093         0.051503226931820146445, 
<a name="l00094"></a>00094         -5.8203519372580372987e-14, 1.2266326995309845825e-12, 
<a name="l00095"></a>00095         -1.3921625844526453237e-11, 6.2228025878281625469e-11, 
<a name="l00096"></a>00096         -8.8636681342142794023e-10, -2.3661241616744818608e-8, 
<a name="l00097"></a>00097         -1.6777870960740520557e-6, -3.2189402882677074318e-4, 
<a name="l00098"></a>00098         0.051503226479551959376, 
<a name="l00099"></a>00099         -4.5801527369223291722e-14, 6.7998819697143727209e-13, 
<a name="l00100"></a>00100         -4.1624857909290468421e-12, -3.2849009406112440998e-11, 
<a name="l00101"></a>00101         -3.247827569043111827e-10, -2.5739209934053714983e-8, 
<a name="l00102"></a>00102         -1.6730566573215739195e-6, -3.2190010909008684076e-4, 
<a name="l00103"></a>00103         0.05150322986693207715
<a name="l00104"></a>00104     };
<a name="l00105"></a>00105 
<a name="l00106"></a>00106     w = fabs(x);
<a name="l00107"></a>00107     <span class="keywordflow">if</span> (w &lt; 8.5) {
<a name="l00108"></a>00108         t = w * w * 0.0625;
<a name="l00109"></a>00109         k = 12 * ((int) t);
<a name="l00110"></a>00110         y = (((((((((((a[k] * t + a[k + 1]) * t + 
<a name="l00111"></a>00111             a[k + 2]) * t + a[k + 3]) * t + a[k + 4]) * t + 
<a name="l00112"></a>00112             a[k + 5]) * t + a[k + 6]) * t + a[k + 7]) * t + 
<a name="l00113"></a>00113             a[k + 8]) * t + a[k + 9]) * t + a[k + 10]) * t + 
<a name="l00114"></a>00114             a[k + 11]) * w;
<a name="l00115"></a>00115     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (w &lt; 12.5) {
<a name="l00116"></a>00116         k = (int) w;
<a name="l00117"></a>00117         t = w - k;
<a name="l00118"></a>00118         k = 14 * (k - 8);
<a name="l00119"></a>00119         y = ((((((((((((b[k] * t + b[k + 1]) * t + 
<a name="l00120"></a>00120             b[k + 2]) * t + b[k + 3]) * t + b[k + 4]) * t + 
<a name="l00121"></a>00121             b[k + 5]) * t + b[k + 6]) * t + b[k + 7]) * t + 
<a name="l00122"></a>00122             b[k + 8]) * t + b[k + 9]) * t + b[k + 10]) * t + 
<a name="l00123"></a>00123             b[k + 11]) * t + b[k + 12]) * t + b[k + 13];
<a name="l00124"></a>00124     } <span class="keywordflow">else</span> {
<a name="l00125"></a>00125         t = 60 / w;
<a name="l00126"></a>00126         k = 9 * ((int) t);
<a name="l00127"></a>00127         y = ((((((((c[k] * t + c[k + 1]) * t + 
<a name="l00128"></a>00128             c[k + 2]) * t + c[k + 3]) * t + c[k + 4]) * t + 
<a name="l00129"></a>00129             c[k + 5]) * t + c[k + 6]) * t + c[k + 7]) * t + 
<a name="l00130"></a>00130             c[k + 8]) * sqrt(t) * exp(w);
<a name="l00131"></a>00131     }
<a name="l00132"></a>00132     <span class="keywordflow">return</span> x &lt; 0 ? -y : y;
<a name="l00133"></a>00133 }
<a name="l00134"></a>00134 
</pre></div></div>
<hr size="1"><address style="text-align: right;"><small>Generated on Fri May 1 12:44:28 2009 for p2f by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.9 </small></address>
</body>
</html>
