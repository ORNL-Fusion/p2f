<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>p2f: src/bessel/dbesk0.c Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.7.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="namespaces.html"><span>Modules</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    </ul>
  </div>
<h1>src/bessel/dbesk0.c</h1><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/* Bessel K_0(x) function in double precision */</span>
<a name="l00002"></a>00002 
<a name="l00003"></a>00003 <span class="preprocessor">#include &lt;math.h&gt;</span>
<a name="l00004"></a>00004 
<a name="l00005"></a>00005 <span class="keywordtype">double</span> dbesk0(<span class="keywordtype">double</span> x)
<a name="l00006"></a>00006 {
<a name="l00007"></a>00007     <span class="keywordtype">int</span> k;
<a name="l00008"></a>00008     <span class="keywordtype">double</span> t, y;
<a name="l00009"></a>00009     <span class="keyword">static</span> <span class="keywordtype">double</span> a[16] = {
<a name="l00010"></a>00010         2.4307270476772195953e-12, 4.709166636378530437e-10, 
<a name="l00011"></a>00011         6.7816861334344265568e-8, 6.7816840204737508252e-6, 
<a name="l00012"></a>00012         4.3402777777915334676e-4, 0.015624999999999872796, 
<a name="l00013"></a>00013         0.25000000000000000448, 0.99999999999999999997, 
<a name="l00014"></a>00014         6.5878327432224993071e-12, 1.2083308769932888218e-9, 
<a name="l00015"></a>00015         1.6271062073716412046e-7, 1.4914719278555277887e-5, 
<a name="l00016"></a>00016         8.4603509071212245667e-4, 0.02524892993216233391, 
<a name="l00017"></a>00017         0.27898287891460312491, 0.11593151565841244874
<a name="l00018"></a>00018     };
<a name="l00019"></a>00019     <span class="keyword">static</span> <span class="keywordtype">double</span> b[112] = {
<a name="l00020"></a>00020         -4.6430702971053162197e-13, 1.037793605956372823e-11, 
<a name="l00021"></a>00021         -1.0298475936392057807e-10, 5.3632747492333959219e-10, 
<a name="l00022"></a>00022         -2.1674628861036068105e-10, -2.3316071545820437669e-8, 
<a name="l00023"></a>00023         2.2557819578691704059e-7, -9.2325694638587080009e-7, 
<a name="l00024"></a>00024         -3.3569097781613661759e-6, 8.7355061305812582974e-5, 
<a name="l00025"></a>00025         -6.8021202111645760475e-4, 2.7434654781323362319e-4, 
<a name="l00026"></a>00026         0.10031787169953909561, 0.42102443824070833334, 
<a name="l00027"></a>00027         4.1447451117883103686e-12, -3.4026589638576604315e-11, 
<a name="l00028"></a>00028         9.3398790624638977468e-12, 1.518418175079985263e-9, 
<a name="l00029"></a>00029         -1.1364911665083029464e-8, 2.0619457602095915719e-8, 
<a name="l00030"></a>00030         3.043101803757224363e-7, -2.974973626447455551e-6, 
<a name="l00031"></a>00031         8.0143661611467038568e-6, 8.0937525149549218398e-5, 
<a name="l00032"></a>00032         -0.0010356346549612699886, 0.0028534806627578638795, 
<a name="l00033"></a>00033         0.097369634474060441807, 0.32175066577856452683, 
<a name="l00034"></a>00034         1.117088257074072752e-13, -8.2865909408297066068e-11, 
<a name="l00035"></a>00035         9.4656678749191182763e-10, -3.583201984184788338e-9, 
<a name="l00036"></a>00036         -9.5017955656904252761e-9, 1.5200595674883329093e-7, 
<a name="l00037"></a>00037         -3.866326257135605998e-7, -3.3350340828235103499e-6, 
<a name="l00038"></a>00038         2.9359886663960844231e-5, -1.1266401822556801563e-5, 
<a name="l00039"></a>00039         -0.0012113572742435576205, 0.0063158973673701376253, 
<a name="l00040"></a>00040         0.088291790250128171341, 0.22833982383240512262, 
<a name="l00041"></a>00041         -3.2880638807053948433e-11, 4.3194884830465283512e-10, 
<a name="l00042"></a>00042         -1.7455089683104033093e-9, -3.2437330799994764516e-9, 
<a name="l00043"></a>00043         4.7393655539139519778e-8, -1.1929265603456272466e-8, 
<a name="l00044"></a>00044         -1.3177845881013419388e-6, 3.3873375636197969526e-6, 
<a name="l00045"></a>00045         3.2729835880668256625e-5, -1.8367283883002494561e-4, 
<a name="l00046"></a>00046         -8.2830996454188084408e-4, 0.0095512732229514251931, 
<a name="l00047"></a>00047         0.072233832113719266702, 0.14753187103603405298, 
<a name="l00048"></a>00048         7.9998492614150860098e-11, -7.025734670268613949e-10, 
<a name="l00049"></a>00049         7.889882162708458627e-10, 1.1294796399671507085e-8, 
<a name="l00050"></a>00050         -1.1360539648638059137e-8, -3.0346309115270564487e-7, 
<a name="l00051"></a>00051         3.2235585426189451721e-7, 8.3575612102298214948e-6, 
<a name="l00052"></a>00052         -8.5169628089198208211e-6, -2.5740175232173357342e-4, 
<a name="l00053"></a>00053         1.246273401468915277e-4, 0.01068323286919220345, 
<a name="l00054"></a>00054         0.051515690033637395779, 0.085465862953544883657, 
<a name="l00055"></a>00055         -8.6111506537356531608e-11, 5.1862926131024597823e-10, 
<a name="l00056"></a>00056         7.5884324949371110022e-10, -6.4011975813006767417e-9, 
<a name="l00057"></a>00057         -4.1966181325111763156e-8, 9.1306285446881485314e-8, 
<a name="l00058"></a>00058         1.3573638315827954034e-6, 4.8683213252735694701e-7, 
<a name="l00059"></a>00059         -3.8805424608710197066e-5, -1.183898646868898061e-4, 
<a name="l00060"></a>00060         9.2796213947750964945e-4, 0.0089611057737319027776, 
<a name="l00061"></a>00061         0.031464453915862785606, 0.04426764808753663078, 
<a name="l00062"></a>00062         4.4400123834164610288e-11, -1.1411233140911074336e-10, 
<a name="l00063"></a>00063         -8.820067070246705983e-10, -1.9686735373323381456e-9, 
<a name="l00064"></a>00064         1.9921120728941773855e-8, 1.454397441858483474e-7, 
<a name="l00065"></a>00065         1.8238418041265854754e-8, -4.5363700392899066037e-6, 
<a name="l00066"></a>00066         -2.1688068222527688542e-5, 4.54960621666870347e-5, 
<a name="l00067"></a>00067         0.0010435238076080528284, 0.0058374528996419979931, 
<a name="l00068"></a>00068         0.01661121071042545585, 0.020756008367065750538, 
<a name="l00069"></a>00069         -6.5166519951106397214e-12, -5.857218285878853958e-11, 
<a name="l00070"></a>00070         1.5550375065815375404e-10, 1.9526509484993563229e-9, 
<a name="l00071"></a>00071         9.2637123346818426594e-9, -1.4136471501812055943e-8, 
<a name="l00072"></a>00072         -4.3024895710889717172e-7, -2.3235612243330592076e-6, 
<a name="l00073"></a>00073         4.0380616133862188804e-7, 9.2783767992909743602e-5, 
<a name="l00074"></a>00074         7.2964887597817095035e-4, 0.0031316245282223273413, 
<a name="l00075"></a>00075         0.0078028233022066428316, 0.0090014807263791058095
<a name="l00076"></a>00076     };
<a name="l00077"></a>00077     <span class="keyword">static</span> <span class="keywordtype">double</span> c[135] = {
<a name="l00078"></a>00078         4.5161032649342790231e-11, -4.2774336988557091369e-11, 
<a name="l00079"></a>00079         6.0998467173896677777e-10, 1.9845167242599996944e-9, 
<a name="l00080"></a>00080         1.3097678767280215271e-8, 7.4505822268382641286e-8, 
<a name="l00081"></a>00081         4.2893920879106814989e-7, 2.3900851955655303104e-6, 
<a name="l00082"></a>00082         1.2533473009382380357e-5, 5.9693359063879871983e-5, 
<a name="l00083"></a>00083         2.477507066108730458e-4, 8.5106703131389516508e-4, 
<a name="l00084"></a>00084         0.0022500105115665788755, 0.00404461344545216346, 
<a name="l00085"></a>00085         0.0036910983340425942762, 
<a name="l00086"></a>00086         3.5732826433251464989e-12, -3.2906649482312266258e-12, 
<a name="l00087"></a>00087         7.0873811190464760555e-11, 2.955132058048417712e-10, 
<a name="l00088"></a>00088         2.2776940472505079894e-9, 1.5175463612815010036e-8, 
<a name="l00089"></a>00089         9.9462487812170164133e-8, 6.14487577978539011e-7, 
<a name="l00090"></a>00090         3.486953188290736075e-6, 1.7615836644757657443e-5, 
<a name="l00091"></a>00091         7.6373536037879531886e-5, 2.7098571871205999668e-4, 
<a name="l00092"></a>00092         7.3399047381788927036e-4, 0.0013439197177355085297, 
<a name="l00093"></a>00093         0.0012439943280131230863, 
<a name="l00094"></a>00094         3.6343547836242523646e-13, 9.7997961751276137602e-14, 
<a name="l00095"></a>00095         1.0184692699811569047e-11, 6.1495184828957652064e-11, 
<a name="l00096"></a>00096         5.0238328349302602543e-10, 3.7498626376004337661e-9, 
<a name="l00097"></a>00097         2.6689445483857236307e-8, 1.7591899737346368084e-7, 
<a name="l00098"></a>00098         1.0486448307010701679e-6, 5.4986458466257148573e-6, 
<a name="l00099"></a>00099         2.4521456351751345323e-5, 8.8900942259143832228e-5, 
<a name="l00100"></a>00100         2.448394771406830019e-4, 4.5418248688489693045e-4, 
<a name="l00101"></a>00101         4.2479574186923180694e-4, 
<a name="l00102"></a>00102         5.2460389348163395857e-14, 7.480206302650350354e-14, 
<a name="l00103"></a>00103         2.0012201610651998417e-12, 1.4887306044735163359e-11, 
<a name="l00104"></a>00104         1.294670541423294035e-10, 1.0391628915892803144e-9, 
<a name="l00105"></a>00105         7.8091180499677328456e-9, 5.3694223626907660084e-8, 
<a name="l00106"></a>00106         3.3063914804658509029e-7, 1.7776972424421486506e-6, 
<a name="l00107"></a>00107         8.0833148098458320202e-6, 2.975555630444881778e-5, 
<a name="l00108"></a>00108         8.2945928349220642178e-5, 1.5536921180500112883e-4, 
<a name="l00109"></a>00109         1.4647070522281538711e-4, 
<a name="l00110"></a>00110         9.7531436733955514559e-15, 2.4084291220447154982e-14, 
<a name="l00111"></a>00111         4.7654956400897494468e-13, 4.0200949504810597783e-12, 
<a name="l00112"></a>00112         3.6726577109162191533e-11, 3.0939005665422637601e-10, 
<a name="l00113"></a>00113         2.4122848979784500179e-9, 1.7071884462645525505e-8, 
<a name="l00114"></a>00114         1.0752238955654933405e-7, 5.8844190041189462347e-7, 
<a name="l00115"></a>00115         2.7136083303224014597e-6, 1.0102477728604441135e-5, 
<a name="l00116"></a>00116         2.8420490721532571809e-5, 5.3637016379451944413e-5, 
<a name="l00117"></a>00117         5.0881312956459247572e-5, 
<a name="l00118"></a>00118         2.173204986818937726e-15, 7.2720052142815590531e-15, 
<a name="l00119"></a>00119         1.28030837955368201e-13, 1.1696825543787717167e-12, 
<a name="l00120"></a>00120         1.1083298191597132094e-11, 9.6536661252658773139e-11, 
<a name="l00121"></a>00121         7.7242553835198536397e-10, 5.579836626711057562e-9, 
<a name="l00122"></a>00122         3.572134529654341437e-8, 1.9806931547193682466e-7, 
<a name="l00123"></a>00123         9.2312964655319555313e-7, 3.4666258590861079959e-6, 
<a name="l00124"></a>00124         9.8224698307751177077e-6, 1.8648773453825584428e-5, 
<a name="l00125"></a>00125         1.7780062316167651812e-5, 
<a name="l00126"></a>00126         5.5012463763851934112e-16, 2.2254763392767319419e-15, 
<a name="l00127"></a>00127         3.7187669817701214965e-14, 3.5819585377733489628e-13, 
<a name="l00128"></a>00128         3.4866061263191556694e-12, 3.110163345062965291e-11, 
<a name="l00129"></a>00129         2.5358235662235617663e-10, 1.8597629779492599046e-9, 
<a name="l00130"></a>00130         1.2052654739462999992e-8, 6.7501417351172136833e-8, 
<a name="l00131"></a>00131         3.1720052198654584574e-7, 1.1993651363602981832e-6, 
<a name="l00132"></a>00132         3.4179130317623363474e-6, 6.5208606745808860158e-6, 
<a name="l00133"></a>00133         6.2430205476536771454e-6, 
<a name="l00134"></a>00134         1.5225407517829491689e-16, 6.9834820025664405161e-16, 
<a name="l00135"></a>00135         1.1380182837138781431e-14, 1.1369488761077196511e-13, 
<a name="l00136"></a>00136         1.1291168681618466716e-12, 1.0250757630526871007e-11, 
<a name="l00137"></a>00137         8.4765287317253141514e-11, 6.2886627779402596211e-10, 
<a name="l00138"></a>00138         4.1142865598366029316e-9, 2.3223773435632014408e-8, 
<a name="l00139"></a>00139         1.0985095234166396934e-7, 4.1766260951820336228e-7, 
<a name="l00140"></a>00140         1.1958609263543792991e-6, 2.2907574647671878055e-6, 
<a name="l00141"></a>00141         2.2008253973114914005e-6, 
<a name="l00142"></a>00142         4.4863058691420695911e-17, 2.2437356594371819978e-16, 
<a name="l00143"></a>00143         3.6107964803015652759e-15, 3.7031193629853392081e-14, 
<a name="l00144"></a>00144         3.7341552790439784371e-13, 3.4355950129497564468e-12, 
<a name="l00145"></a>00145         2.8719942600171304499e-11, 2.1499646844509516453e-10, 
<a name="l00146"></a>00146         1.4171810843455227171e-9, 8.0501118772875784153e-9, 
<a name="l00147"></a>00147         3.8281889106330295876e-8, 1.4621673458431979989e-7, 
<a name="l00148"></a>00148         4.2029868696411098586e-7, 8.0785884122023473025e-7, 
<a name="l00149"></a>00149         7.7845438614204963209e-7
<a name="l00150"></a>00150     };
<a name="l00151"></a>00151     <span class="keyword">static</span> <span class="keywordtype">double</span> d[40] = {
<a name="l00152"></a>00152         -7.9737703860537066166e-14, 1.9543834380466766627e-12, 
<a name="l00153"></a>00153         -4.7230794431646733538e-11, 1.4001773785771252004e-9, 
<a name="l00154"></a>00154         -5.4864553020583098585e-8, 3.1601984250143742772e-6, 
<a name="l00155"></a>00155         -3.3708783204090252161e-4, 0.16180215937964160437, 
<a name="l00156"></a>00156         -5.2593898374798632343e-14, 1.7725913926973236457e-12, 
<a name="l00157"></a>00157         -4.6672234858122387294e-11, 1.3991653503828889207e-9, 
<a name="l00158"></a>00158         -5.4863400156413929639e-8, 3.1601976099900075541e-6, 
<a name="l00159"></a>00159         -3.3708783171335864627e-4, 0.1618021593795843376, 
<a name="l00160"></a>00160         -3.6135496189875398132e-14, 1.5466239429618130284e-12, 
<a name="l00161"></a>00161         -4.5320259146602122624e-11, 1.3945974109459385552e-9, 
<a name="l00162"></a>00162         -5.4853994841172088787e-8, 3.1601858228022739196e-6, 
<a name="l00163"></a>00163         -3.370878233999830232e-4, 0.16180215937704286491, 
<a name="l00164"></a>00164         -2.5640663123518180635e-14, 1.3288079339404032671e-12, 
<a name="l00165"></a>00165         -4.3368537955908371563e-11, 1.3848103653102203186e-9, 
<a name="l00166"></a>00166         -5.4824335664256344123e-8, 3.1601315173126153586e-6, 
<a name="l00167"></a>00167         -3.370877677903569564e-4, 0.16180215935248373474, 
<a name="l00168"></a>00168         -1.8678321325292127767e-14, 1.1354310934105733311e-12, 
<a name="l00169"></a>00169         -4.1057197297998608931e-11, 1.369399096129635097e-9, 
<a name="l00170"></a>00170         -5.4762428935047089835e-8, 3.1599817092775027963e-6, 
<a name="l00171"></a>00171         -3.3708756559715893599e-4, 0.1618021592350814424
<a name="l00172"></a>00172     };
<a name="l00173"></a>00173 
<a name="l00174"></a>00174     <span class="keywordflow">if</span> (x &lt; 0.86) {
<a name="l00175"></a>00175         t = x * x;
<a name="l00176"></a>00176         y = ((((((a[0] * t + a[1]) * t + 
<a name="l00177"></a>00177             a[2]) * t + a[3]) * t + a[4]) * t + 
<a name="l00178"></a>00178             a[5]) * t + a[6]) * t + a[7];
<a name="l00179"></a>00179         y = ((((((a[8] * t + a[9]) * t + 
<a name="l00180"></a>00180             a[10]) * t + a[11]) * t + a[12]) * t + 
<a name="l00181"></a>00181             a[13]) * t + a[14]) * t + a[15] - y * log(x);
<a name="l00182"></a>00182     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (x &lt; 4.15) {
<a name="l00183"></a>00183         t = x - 5 / x;
<a name="l00184"></a>00184         k = (int) (t + 5);
<a name="l00185"></a>00185         t = (k - 4) - t;
<a name="l00186"></a>00186         k *= 14;
<a name="l00187"></a>00187         y = ((((((((((((b[k] * t + b[k + 1]) * t + 
<a name="l00188"></a>00188             b[k + 2]) * t + b[k + 3]) * t + b[k + 4]) * t + 
<a name="l00189"></a>00189             b[k + 5]) * t + b[k + 6]) * t + b[k + 7]) * t + 
<a name="l00190"></a>00190             b[k + 8]) * t + b[k + 9]) * t + b[k + 10]) * t + 
<a name="l00191"></a>00191             b[k + 11]) * t + b[k + 12]) * t + b[k + 13];
<a name="l00192"></a>00192     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (x &lt; 12.5) {
<a name="l00193"></a>00193         k = (int) x;
<a name="l00194"></a>00194         t = (k + 1) - x;
<a name="l00195"></a>00195         k = 15 * (k - 4);
<a name="l00196"></a>00196         y = (((((((((((((c[k] * t + c[k + 1]) * t + 
<a name="l00197"></a>00197             c[k + 2]) * t + c[k + 3]) * t + c[k + 4]) * t + 
<a name="l00198"></a>00198             c[k + 5]) * t + c[k + 6]) * t + c[k + 7]) * t + 
<a name="l00199"></a>00199             c[k + 8]) * t + c[k + 9]) * t + c[k + 10]) * t + 
<a name="l00200"></a>00200             c[k + 11]) * t + c[k + 12]) * t + c[k + 13]) * t + 
<a name="l00201"></a>00201             c[k + 14];
<a name="l00202"></a>00202     } <span class="keywordflow">else</span> {
<a name="l00203"></a>00203         t = 60 / x;
<a name="l00204"></a>00204         k = 8 * ((int) t);
<a name="l00205"></a>00205         y = (((((((d[k] * t + d[k + 1]) * t + 
<a name="l00206"></a>00206             d[k + 2]) * t + d[k + 3]) * t + d[k + 4]) * t + 
<a name="l00207"></a>00207             d[k + 5]) * t + d[k + 6]) * t + d[k + 7]) * 
<a name="l00208"></a>00208             sqrt(t) * exp(-x);
<a name="l00209"></a>00209     }
<a name="l00210"></a>00210     <span class="keywordflow">return</span> y;
<a name="l00211"></a>00211 }
<a name="l00212"></a>00212 
</pre></div></div>
<hr size="1"><address style="text-align: right;"><small>Generated on Fri May 1 12:02:22 2009 for p2f by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.7.1 </small></address>
</body>
</html>
